# Reverse Engineering of the Time Calculation App

This document breaks down the architecture, file structure, and logic of the Weekly Time Tracker application.

## 1. High-Level Architecture

The application is a purely client-side web application. This means it runs entirely within the user's web browser and does not require an internet connection or a backend server. All logic is handled by JavaScript, all content is structured by HTML, and all styling is managed by CSS.

- **Data Persistence:** The app saves all user data (categories and times) to the browser's `localStorage`. This allows the data to persist even when the browser is closed or the page is refreshed.
- **UI Rendering:** The user interface is dynamically generated by JavaScript. The main table of categories is not hardcoded in the HTML but is built on the fly based on the data found in `localStorage`.
- **Reactivity:** The UI updates instantly on user input without full page reloads. This is achieved by specifically targeting and updating only the parts of the page that need to change, providing a smooth user experience.

## 2. File Structure

The project consists of three core files:

- `index.html`: The main entry point of the application. It defines the basic structure, including the main container, the table headers, the form for adding new categories, and the summary section. It also links to the CSS and JavaScript files.
- `style.css`: Contains all the visual styling rules. This includes the layout of the page, colors, fonts, table appearance, and the styling of input fields and buttons.
- `script.js`: The "brains" of the application. It contains all the application logic.

## 3. Data Structure

The application's state is managed in a single JavaScript object, which is then saved to `localStorage` as a JSON string under the key `timeDataV4`.

The structure of this data is as follows:

```json
{
  "CategoryName1": { "h": 8, "m": 30 },
  "CategoryName2": { "h": 2, "m": 15 },
  "CategoryName3": { "h": 0, "m": 45 }
}
```

- Each key in the main object is a string representing the category name (e.g., "Sleep").
- The value for each category is another object containing two properties:
  - `h`: An integer for the hours spent daily.
  - `m`: An integer for the minutes spent daily.

## 4. Core JavaScript Logic (`script.js`)

The script executes when the DOM is fully loaded. Here is a breakdown of its key functions and event handlers:

### Initialization and Data Management

1.  **`loadData()`**: 
    - Called once when the page loads.
    - It tries to retrieve the JSON string from `localStorage` using the key `timeDataV4`.
    - It parses this string into the `timeData` JavaScript object.
    - If no data is found (e.g., first-time use), it initializes `timeData` with default categories like 'Sleep' and 'Work'.
    - After loading, it calls `renderTable()` to build the initial UI.

2.  **`saveData()`**: 
    - Called whenever any change is made to the `timeData` object.
    - It converts the `timeData` object into a JSON string.
    - It saves this string to `localStorage`.

### UI Rendering

1.  **`renderTable()`**: 
    - This function is responsible for building the HTML for the category table. It is called only when the structure changes (on load, or when a category is added/deleted).
    - It clears the existing table body.
    - It iterates through each category in the `timeData` object.
    - For each category, it calculates the decimal hours and the weekly total.
    - It creates a new table row (`<tr>`) containing the category name, the hour/minute input fields, the calculated weekly total, and a delete button.
    - It appends this new row to the table body.
    - After the loop, it calls `updateOverallSummary()`.

2.  **`updateOverallSummary()`**: 
    - This function calculates the grand total of all weekly hours from the `timeData` object.
    - It updates the `textContent` of the "Total hours spent" and "Remaining hours" elements at the bottom of the page.

### Event Handling

The script uses event delegation on the `tableBody` for efficient handling of events on dynamically created elements.

1.  **`addCategoryBtn` 'click' handler**:
    - When the "Add Category" button is clicked, it gets the new category name from the input field.
    - It adds the new category to the `timeData` object with default values (`{h: 0, m: 0}`).
    - It calls `saveData()` and `renderTable()` to update the UI.

2.  **`tableBody` 'input' handler**:
    - This is the key to the smooth UI. It fires whenever the user types in any hour or minute input field.
    - It identifies which category and which input (hour or minute) was changed.
    - It updates the corresponding `h` or `m` value in the `timeData` object.
    - **Crucially, it does NOT re-render the whole table.** Instead, it recalculates the weekly total for *only the edited row* and updates that single cell's text.
    - It then calls `updateOverallSummary()` to update the totals at the bottom.
    - Finally, it calls `saveData()`.

3.  **`tableBody` 'click' handler**:
    - This handles clicks on the "Delete" buttons.
    - It identifies the category of the row that was clicked.
    - It shows a confirmation dialog.
    - If confirmed, it deletes the category from the `timeData` object.
    - It calls `saveData()` and `renderTable()` to rebuild the table without the deleted row.
